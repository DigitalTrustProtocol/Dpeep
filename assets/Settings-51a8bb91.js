import{h,T as S,$ as L,D as _,t as l,E as A,K as w,G as R,o as e,S as m,J as E,C as k,m as b,H as I,p as f,l as d,L as P,O as U,U as V,W as u,X as Z,Y as D,Z as B,a0 as O,a1 as K}from"./index-88716094.js";const W=()=>{const[t,s]=h(!1),r=S(y=>{y?L("/logout"):_.logOut()},[]),i=async y=>{y.preventDefault();const a=await window.nostr.getPublicKey();w.login({rpub:a})},c=S(()=>{confirm(`${l("delete_account")}?`)&&(A.publish({kind:0,content:JSON.stringify({deleted:!0})}),A.publish({kind:3,content:JSON.stringify({})}),setTimeout(()=>{_.logOut()},1e3))},[]),n=w.getPrivKey();let o;n&&(o=R.nsecEncode(n));const p=w.getPubKey(),g=R.npubEncode(p),v=!!w.getPrivKey();return e("div",{class:"centered-container",children:[e("h2",{children:l("account")}),e(m,{when:v,children:e("p",{children:[e("b",{children:l("save_backup_of_privkey_first")})," ",l("otherwise_cant_log_in_again")]})}),e("div",{className:"flex gap-2 my-2",children:[e("button",{className:"btn btn-sm btn-primary",onClick:()=>r(v),children:l("log_out")}),e("button",{className:"btn btn-sm btn-primary",onClick:()=>s(!t),children:l("switch_account")})]}),e(m,{when:t,children:[e("p",{children:e(E,{onBack:()=>s(!1)})}),e("p",{children:e("a",{href:"#",onClick:i,children:l("nostr_extension_login")})})]}),e("h3",{children:l("public_key")}),e("p",{children:e("small",{children:g})}),e("div",{className:"flex gap-2 my-2",children:[e(k,{className:"btn btn-neutral btn-sm",copyStr:g,text:"Copy npub"}),e(k,{className:"btn btn-neutral btn-sm",copyStr:p,text:"Copy hex"})]}),e("h3",{children:l("private_key")}),e("div",{className:"flex gap-2 my-2",children:[e(m,{when:n,children:e(b,{children:[e(k,{className:"btn btn-neutral btn-sm",copyStr:o,text:"Copy nsec"}),e(k,{className:"btn btn-neutral btn-sm",copyStr:n,text:"Copy hex"})]})}),e(m,{when:!n,children:e("p",{children:l("private_key_not_present_good")})})]}),e(m,{when:n,children:e("p",{children:l("private_key_warning")})}),e(m,{when:I.isStandalone(),children:[e("h3",{children:l("delete_account")}),e("p",{children:e("button",{className:"btn btn-sm btn-danger",onClick:c,children:l("delete_account")})})]})]})},F=()=>{const[t,s]=h(!1);return f(()=>{d.get("showConnectedRelays").on(s)},[]),e(b,{children:e("div",{class:"centered-container",children:[e("h3",{children:l("appearance")}),e("p",{children:[e("input",{className:"checkbox",type:"checkbox",id:"showConnectedRelays",name:"showConnectedRelays",checked:t,onChange:r=>{d.get("showConnectedRelays").put(r.currentTarget.checked)}}),e("label",{htmlFor:"showConnectedRelays",children:[" ",l("show_connected_relays_in_header")]})]})]})})};function G(){const[t,s]=h({});f(()=>{const n=d.get("settings").on(o=>{s(o)},!1,1);return()=>n()},[]);const r=[{setting:"loadReactions",label:"Replies and reactions"},{setting:"showLikes",label:"Likes"},{setting:"showZaps",label:"Zaps"},{setting:"showReposts",label:"Reposts"}],i=[{setting:"enableImages",label:"Images"},{setting:"enableAudio",label:"Audio"},{setting:"enableVideo",label:"Videos"},{setting:"autoplayVideos",label:"Autoplay videos"},{setting:"enableAppleMusic",label:"Apple Music"},{setting:"enableInstagram",label:"Instagram"},{setting:"enableSoundCloud",label:"SoundCloud"},{setting:"enableSpotify",label:"Spotify"},{setting:"enableTidal",label:"Tidal"},{setting:"enableTiktok",label:"TikTok"},{setting:"enableTwitch",label:"Twitch"},{setting:"enableTwitter",label:"Twitter"},{setting:"enableYoutube",label:"YouTube"},{setting:"enableWavlake",label:"Wavlake"}],c=n=>{d.get("settings").get(n).put(t[n]===!1)};return e("div",{class:"centered-container",children:[e("h2",{children:l("content")}),e("h3",{children:l("notes")}),r.map(({setting:n,label:o})=>e("p",{children:[e("input",{type:"checkbox",checked:t[n]!==!1,onChange:()=>c(n),id:n}),e("label",{htmlFor:n,children:[" ",o]})]},n)),e("h3",{children:l("media")}),i.map(({setting:n,label:o})=>e("p",{children:[e("input",{type:"checkbox",checked:t[n]!==!1,onChange:()=>c(n),id:n}),e("label",{htmlFor:n,children:[" ",o]})]},n))]})}function M(){const[t,s]=h({});f(()=>{const c=d.get("dev").on(n=>s(n),!1,1);return()=>c()},[]);const r=(c,n,o)=>e("p",{children:[e("input",{type:"checkbox",id:c,checked:t[c]===void 0?o:t[c],onChange:p=>{const g=p.target.checked;d.get("dev").get(c).put(g)}}),e("label",{htmlFor:c,children:n})]}),i=[{key:"logSubscriptions",label:"Log RelayPool subscriptions",defaultValue:!1},{key:"indexedDbSave",label:"Save events to IndexedDB",defaultValue:!0},{key:"indexedDbLoad",label:"Load events from IndexedDB",defaultValue:!0},{key:"askEventsFromRelays",label:"Ask events from relays",defaultValue:!0}];return e("div",{class:"centered-container",children:[e("h3",{children:"Developer"}),e("p",{children:"Settings intended for Iris developers."}),i.map(({key:c,label:n,defaultValue:o})=>r(c,n,o))]})}const Y=()=>e(b,{children:e("div",{class:"centered-container",children:[e("h3",{children:l("language")}),e("div",{class:"centered-container",children:Object.keys(P).map(t=>{let s;return t==U?s=e("input",{type:"radio",name:"language",id:t,onChange:r=>T(r),value:t,checked:!0}):s=e("input",{type:"radio",name:"language",id:t,onChange:r=>T(r),value:t}),e(b,{children:[s,e("label",{for:t,children:[" ",P[t]]}),e("br",{})]},t)})})]})});function T(t){const s=t.target.value;V.indexOf(s)>=0&&(localStorage.setItem("language",s),location.reload())}const $=()=>{const[t,s]=h(Array.from(u.relays.values())),[r,i]=h([]),[c,n]=h("");f(()=>{const a=setInterval(()=>{s(Array.from(u.relays.values()))},2e3);return()=>clearInterval(a)}),f(()=>{i(u.getPopularRelays())},[]);const o=a=>{d.get("relays").get(a.url).put(null),u.remove(a.url)},p=a=>a.includes("://")?a:`wss://${a}`,g=(a,x)=>{const N=p(x);d.get("relays").get(N).put({enabled:!0,newRelayUrlWithProtocol:N}),a.preventDefault(),u.add(N),n("")},v=a=>{try{return Z().relayByUrl.get(a.url).status}catch{return 3}},y=a=>{switch(v(a)){case 0:return"text-iris-yellow";case 1:return"text-iris-green";case 2:return"text-iris-yellow";case 3:return"";default:return"status"}};return e("div",{className:"centered-container",children:[e("h2",{children:l("network")}),e("div",{className:"flex flex-col gap-2",children:[t.map(a=>e("div",{className:"flex gap-2 flex-row peer",children:[e("div",{className:"flex-1 truncate max-w-[60vw]",children:[e("span",{className:y(a),children:"â¬¤ "}),a.url]},a.url),e("button",{className:"btn btn-neutral btn-sm",onClick:()=>o(a),children:l("remove")}),e("input",{className:"checkbox",type:"checkbox",checked:a.enabled!==!1,onChange:()=>{a.enabled=a.enabled===!1,a.enabled?u.enable(a.url):u.disable(a.url)}})]})),e("div",{className:"flex flex-row peer gap-2",children:[e("div",{className:"flex-cell",children:e("input",{className:"input",id:"new-relay-url",type:"text",placeholder:l("new_relay_url"),value:c,onChange:a=>n(a.target.value)})},"new"),e("div",{className:"flex-cell no-flex",children:e("button",{className:"btn btn-neutral",onClick:a=>g(a,c),children:l("add")})})]}),e("div",{className:"flex gap-2 my-2",children:[e("button",{className:"btn btn-neutral",onClick:()=>u.saveToContacts(),children:l("save_relays_publicly")}),e("button",{className:"btn btn-neutral",onClick:()=>u.restoreDefaults(),children:l("restore_defaults")})]})]}),e("h3",{children:l("popular_relays")}),e("div",{className:"flex flex-col gap-2",children:[e("div",{className:"flex peer gap-2",children:[e("div",{className:"flex-initial",children:l("users")}),e("div",{className:"flex-grow",children:"URL"})]}),r.map(a=>e("div",{className:"flex peer gap-2",children:[e("div",{className:"flex-initial",children:a.users}),e("div",{className:"flex-grow truncate max-w-[60vw]",children:a.url}),e("div",{className:"flex-initial",children:e("button",{className:"btn btn-sm btn-neutral",onClick:x=>g(x,a.url),children:l("add")})})]},a.url))]})]})},J=()=>{const[t,s]=h("USD"),[r,i]=h(1e3);f(()=>{d.get("displayCurrency").on(n=>{s(n)})},[]),f(()=>{d.get("defaultZapAmount").on(n=>{i(n)})},[]);const c=n=>{const p=n.target.value;d.get("displayCurrency").put(p)};return e(b,{children:e("div",{class:"centered-container",children:[e("h3",{children:l("payments")}),e("p",{children:["Payments on Iris are called Zaps and are made with Bitcoin."," ",e("a",{href:"https://github.com/irislib/faq#zapping",children:"FAQ"})]}),e("p",{children:[e("label",{for:"displayCurrency",children:l("display_currency")}),e("select",{className:"select",id:"displayCurrency",name:"displayCurrency",onChange:c,value:t,children:[e("option",{value:"USD",children:"USD"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"JPY",children:"JPY"}),e("option",{value:"BTC",children:"SATS (Satoshi, 0.00000001 BTC)"})]})]}),e("p",{children:[e("label",{for:"defaultZapAmount",children:[l("default_zap_amount")," (sats):"]}),e("input",{className:"input",type:"number",id:"defaultZapAmount",name:"defaultZapAmount",value:r,onChange:n=>{d.get("defaultZapAmount").put(n.currentTarget.value)}})]})]})})},H=t=>e(b,{children:[e(D,{}),e("div",{className:"flex justify-between mb-4",children:e("span",{className:"text-2xl font-bold",children:e("span",{style:{flex:1},className:"ml-1",children:"Settings"})})}),e("hr",{className:"-mx-2 opacity-10 my-2"}),e(B,{}),e("hr",{className:"-mx-2 opacity-10 my-2"})]}),j=t=>{const s={account:W,network:$,appearance:F,language:Y,content:G,payments:J,dev:M,dwotr:H,metrics:O},r=s[t.id]||s.account;return e("div",{className:"prose",children:e(r,{})})},C={account:"account",appearance:"appearance",content:"content",payments:"payments",network:"network",language:"language",dwotr:"DWoTR",metrics:"Metrics"},z=t=>{const s=t.activePage||"account",r=(i,c)=>{c.preventDefault(),d.get("toggleSettingsMenu").put(!1),d.get("scrollUp").put(!0),L(`/settings/${i}`)};return e("div",{className:`flex-col w-full md:w-48 flex-shrink-0 ${t.activePage?"hidden md:flex":"flex"}`,children:Object.keys(C).map(i=>C[i]?e("a",{href:"#",className:`btn inline-flex w-auto flex items-center p-3 rounded-full transition-colors duration-200 hover:bg-neutral-900 ${s===i&&window.innerWidth>640?"active":""}`,onClick:c=>r(i,c),children:[e("span",{class:"text",children:l(C[i])}),e(m,{when:i==="language",children:e(K,{width:16})})]},i):null)})},Q=t=>e(b,{children:[e(D,{}),e("div",{className:"flex flex-row px-2 md:px-0",children:[e(z,{activePage:t.page}),e("div",{className:t.page?"":"hidden md:flex",children:e(j,{id:t.page})})]})]});export{Q as default};
